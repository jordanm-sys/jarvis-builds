<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>Resume Tailor</title>
<style>
:root{--bg:#0d1117;--surface:#161b22;--surface2:#21262d;--border:#30363d;--text:#e6edf3;--text2:#8b949e;--accent:#58a6ff;--accent2:#3fb950;--danger:#f85149;--radius:8px}
*{margin:0;padding:0;box-sizing:border-box}
body{background:var(--bg);color:var(--text);font-family:-apple-system,BlinkMacSystemFont,'Segoe UI',sans-serif;min-height:100vh}
.container{max-width:1200px;margin:0 auto;padding:20px}
header{display:flex;align-items:center;justify-content:space-between;padding:16px 0;border-bottom:1px solid var(--border);margin-bottom:24px}
header h1{font-size:22px;display:flex;align-items:center;gap:8px}
.tabs{display:flex;gap:4px}
.tab{padding:8px 16px;border-radius:var(--radius);cursor:pointer;font-size:14px;color:var(--text2);background:transparent;border:1px solid transparent;transition:all .2s}
.tab:hover{color:var(--text);background:var(--surface)}
.tab.active{color:var(--text);background:var(--surface);border-color:var(--border)}
.panel{display:none}
.panel.active{display:block}

/* Forms */
textarea,input{width:100%;padding:12px;background:var(--surface);border:1px solid var(--border);border-radius:var(--radius);color:var(--text);font-size:14px;font-family:inherit;resize:vertical}
textarea:focus,input:focus{outline:none;border-color:var(--accent)}
label{display:block;font-size:13px;color:var(--text2);margin-bottom:6px;margin-top:16px}
label:first-child{margin-top:0}
.btn{padding:10px 20px;border:none;border-radius:var(--radius);cursor:pointer;font-size:14px;font-weight:600;transition:all .2s}
.btn-primary{background:var(--accent);color:#fff}
.btn-primary:hover{opacity:.9}
.btn-primary:disabled{opacity:.5;cursor:not-allowed}
.btn-success{background:var(--accent2);color:#fff}
.btn-danger{background:var(--danger);color:#fff;font-size:12px;padding:6px 12px}
.btn-ghost{background:transparent;border:1px solid var(--border);color:var(--text2)}
.btn-ghost:hover{border-color:var(--text2)}
.btn-row{display:flex;gap:8px;margin-top:20px;flex-wrap:wrap}

/* Resume Setup */
.status-badge{display:inline-flex;align-items:center;gap:6px;padding:4px 10px;border-radius:20px;font-size:12px}
.status-badge.saved{background:#1a3a2a;color:var(--accent2)}
.status-badge.empty{background:#3a1a1a;color:var(--danger)}

/* Tailor */
.grid-2{display:grid;grid-template-columns:1fr 1fr;gap:20px}
@media(max-width:768px){.grid-2{grid-template-columns:1fr}}
.result-card{background:var(--surface);border:1px solid var(--border);border-radius:var(--radius);padding:20px;margin-top:16px}
.result-card h3{font-size:16px;margin-bottom:12px;display:flex;align-items:center;gap:8px}
.result-card .content{font-size:14px;line-height:1.7;white-space:pre-wrap;color:var(--text2)}
.result-card .content h1,.result-card .content h2,.result-card .content h3{color:var(--text);margin-top:12px}
.result-card .content strong{color:var(--text)}
.keywords{display:flex;flex-wrap:wrap;gap:6px;margin-top:8px}
.keyword{background:var(--surface2);padding:4px 10px;border-radius:20px;font-size:12px;color:var(--accent)}
.ats-score{font-size:36px;font-weight:700;text-align:center;padding:20px}
.ats-score.high{color:var(--accent2)}
.ats-score.mid{color:#d29922}
.ats-score.low{color:var(--danger)}
.tips{list-style:none;padding:0}
.tips li{padding:6px 0;font-size:13px;color:var(--text2);border-bottom:1px solid var(--border)}
.tips li:last-child{border:none}
.tips li::before{content:'ðŸ’¡ '}

/* History */
.history-card{background:var(--surface);border:1px solid var(--border);border-radius:var(--radius);padding:16px;margin-bottom:12px}
.history-card .meta{display:flex;justify-content:space-between;align-items:center;margin-bottom:8px}
.history-card .meta h3{font-size:15px}
.history-card .meta span{font-size:12px;color:var(--text2)}
.history-card .meta-row{font-size:13px;color:var(--text2);margin-bottom:8px}

/* Loading */
.spinner{display:inline-block;width:20px;height:20px;border:2px solid var(--border);border-top-color:var(--accent);border-radius:50%;animation:spin .8s linear infinite}
@keyframes spin{to{transform:rotate(360deg)}}
.loading-overlay{display:none;position:fixed;inset:0;background:rgba(0,0,0,.7);z-index:100;align-items:center;justify-content:center;flex-direction:column;gap:16px;color:var(--text)}
.loading-overlay.active{display:flex}
.loading-overlay .spinner{width:40px;height:40px;border-width:3px}
.empty-state{text-align:center;padding:60px 20px;color:var(--text2)}
.empty-state .icon{font-size:48px;margin-bottom:16px}
</style>
</head>
<body>
<div class="container">
  <header>
    <h1>ðŸ“„ Resume Tailor</h1>
    <div class="tabs">
      <div class="tab active" onclick="switchTab('tailor')">âœ¨ Tailor</div>
      <div class="tab" onclick="switchTab('resume')">ðŸ“‹ My Resume</div>
      <div class="tab" onclick="switchTab('history')">ðŸ“‚ History</div>
    </div>
  </header>

  <!-- Tailor Panel -->
  <div class="panel active" id="panel-tailor">
    <div id="noResume" style="display:none">
      <div class="empty-state">
        <div class="icon">ðŸ“‹</div>
        <h2>No resume saved yet</h2>
        <p style="margin-top:8px">Go to "My Resume" tab and paste your master resume first.</p>
      </div>
    </div>
    <div id="tailorForm">
      <div class="grid-2">
        <div>
          <label>Company Name (optional)</label>
          <input id="company" placeholder="e.g. Google, TD Bank, Shopify">
          <label>Role / Position (optional)</label>
          <input id="role" placeholder="e.g. Software Engineering Intern">
        </div>
        <div>
          <label>Job Posting *</label>
          <div style="display:flex;gap:8px;margin-bottom:8px">
            <button class="btn btn-ghost" onclick="document.getElementById('jobUpload').click()">ðŸ“Ž Upload PDF/.docx</button>
            <input type="file" id="jobUpload" accept=".pdf,.docx,.txt" style="display:none" onchange="uploadJobFile(this)">
            <span id="jobUploadStatus" style="font-size:13px;color:var(--text2);align-self:center"></span>
          </div>
          <textarea id="jobPosting" rows="6" placeholder="Paste or upload the job description..."></textarea>
        </div>
      </div>
      <div class="btn-row">
        <button class="btn btn-primary" id="tailorBtn" onclick="tailorResume()">âœ¨ Tailor My Resume</button>
      </div>
    </div>
    
    <div id="results" style="display:none">
      <div style="display:flex;align-items:center;justify-content:space-between;margin-top:24px;margin-bottom:8px">
        <h2>Results</h2>
        <div style="display:flex;gap:8px;align-items:center">
          <div id="atsInline" class="status-badge saved"></div>
          <button class="btn btn-ghost" onclick="document.getElementById('results').style.display='none'">Close</button>
        </div>
      </div>
      <div class="grid-2">
        <div class="result-card">
          <h3>ðŸ“„ Tailored Resume <button class="btn btn-ghost" style="margin-left:auto;font-size:12px;paddingÒ»Ðµ